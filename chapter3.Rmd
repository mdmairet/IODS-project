---
title: "Chapter#3: Logistic regression"
author: "Marc Denojean-Mairet"
date: "18/11/2021"
output: html_document
---

# Logistic regression

Read new data frame named alc.csv to studentAlc and print variable names.


```{r}


#studentAlc <- read.table("~/IODS-project/IODS-project/data/pormath.csv", sep = ",", header = TRUE)

studentAlc <- read.table("~/IODS-project/IODS-project/data/alc.csv", sep = ",", header = TRUE)

dim(studentAlc)

colnames(studentAlc)

```

**Data Set Information:**

"This data approach student achievement in secondary education of two Portuguese schools. The data attributes include student grades, demographic, social and school related features) and it was collected by using school reports and questionnaires. Two datasets are provided regarding the performance in two distinct subjects: Mathematics (mat) and Portuguese language (por). In [Cortez and Silva, 2008], the two datasets were modeled under binary/five-level classification and regression tasks. Important note: the target attribute G3 has a strong correlation with attributes G2 and G1. This occurs because G3 is the final year grade (issued at the 3rd period), while G1 and G2 correspond to the 1st and 2nd period grades. It is more difficult to predict G3 without G2 and G1, but such prediction is much more useful (see paper source for more details)."

The above information is from UCI Machine Learning Repository.

More information about the data sets can be found here:(https://archive.ics.uci.edu/ml/datasets/Student+Performance)


I chose the following 4 variables to predict high use of alcohol:  G3, absences, Pstatus, and health.  I have chosen these variables thinking that they would be easily available to a school without the need to survey students.

**G3**:

My assumption here is that low grade is an indication of high alcohol use since high use of alcohol can affect cognitive functions such as memory.

**absences**:

High number of absences could be an indication of high alcohol use as it would affect one's schedule.  Absenses could be due to being sick after consuming a lot of alcohol.

**goout**

Going out with friend a lot might raise alcohol consumption since there will be more opportunities to consume alcohol.


**health**:

Poor health could be an indication of high alcohol consumption.  Alcohol can negatively affect physical and mental health.

### These are plots of all variables

```{r}
# access the tidyverse libraries tidyr, dplyr, ggplot2
library(tidyr); library(dplyr); library(ggplot2)
# draw a bar plot of each variable
gather(studentAlc) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar()

```

### Box plots of my chosen variables vs high-use of alcohol

```{r}
# initialize a plot of high_use and G3
g1 <- ggplot(studentAlc, aes(x = high_use, y = G3, col = sex))

# define the plot as a boxplot and draw it
g1 + geom_boxplot() + ylab("grade") + ggtitle("Student final grade by alcohol consumption and sex")

# initialise a plot of high_use and absences
g2 <- ggplot(studentAlc, aes(x = high_use, y = absences, col = sex))

# define the plot as a boxplot and draw it
g2 + geom_boxplot() + ggtitle("Student absences by alcohol consumption and sex")

# initialize a plot of high_use and 
g3 <- ggplot(studentAlc, aes(x = high_use, y = goout, col = sex))

# define the plot as a boxplot and draw it
g3 + geom_boxplot() + ylab("going out") + ggtitle("Student going out with friends by alcohol consumption and sex")

g4 <- ggplot(studentAlc, aes(x = high_use, y = health, col = sex))

# define the plot as a boxplot and draw it
g4 + geom_boxplot() + ylab("health") + ggtitle("Student health by alcohol consumption and sex")
```

## Numerical exploration of my chosen variables

```{r}
# produce summary statistics by grade
studentAlc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_grade = mean(G3))

# produce summary statistics by absences
studentAlc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_absences = mean(absences))

# produce summary statistics by going out
studentAlc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_going_out = mean(goout))

# produce summary statistics by health
studentAlc %>% group_by(sex, high_use) %>% summarise(count = n(), mean_health = mean(health))
```

